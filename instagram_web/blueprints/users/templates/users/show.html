{% extends "_layout.html" %}
{% block content %}
<div class="container-fluid pt-5">
    <div class="row justify-content-start align-items-start">
        <div class="col-md-3 text-center m-5">
            <div class="profile-photo mb-3">
                <img src="{{ user.profile_image_url }}" />
            </div>
            <p><strong>{{user.name}}</strong><br/>
            @{{user.username}}
            </p>
            <div class="row" style="font-size: .8em">
                <div class="col">
                    <strong class="text-success">{{ photos.count() }}</strong> posts
                </div>
                <div class="col">
                    <strong class="text-success">{{ user.followers.count() }}</strong> followers
                </div>
                <div class="col">
                    <strong class="text-success">{{ user.following.count() }}</strong> following
                </div>
            </div>
            {% if current_user in user.followers and user.is_approved(current_user.id) %}
            <div class="m-2 p-2">
                <a href="{{ url_for('users.unfollow', follower_id=current_user.id, following_id=user.id) }}"><button
                        class="btn btn-outline-success">Unfollow</button></a>
            </div>
            {% elif current_user in user.followers %}
            <div class="m-2 p-2">
                <button
                    class="btn btn-success" disabled>Requested</button>
            </div>
            {% elif user != current_user and user.is_public == True %}
            <div class="m-2 p-2">
                <a href="{{ url_for('users.follow', follower_id=current_user.id, following_id=user.id) }}"><button
                        class="btn btn-success">Follow</button></a>
            </div>
            {% elif user != current_user and user.is_public == False %}
            <div class="m-2 p-2">
                <a href="{{ url_for('users.follow', follower_id=current_user.id, following_id=user.id) }}"><button
                        class="btn btn-success">Request</button></a>
            </div>
            {% endif %}
        </div>
        <div class="col-md-7 px-1 pt-3 user-photos">
            {% if (current_user == user) or (user.is_public) or (current_user in user.followers and user.is_approved(current_user.id)) %}
            <ul id="grid">
                {% for photo in photos %}
                <li class="gallery-item" currentSlide="{{ loop.index }}">
                    <img src="{{ photo.url }}" />
                    <p class="caption">{{ photo.caption }}</p>
                    <div class="middle"> 
                        <a href="{{ url_for('transactions.new', image_id=photo.id) }}"><button type="button" class=" btn btn-success donate-button">Donate</button></a>
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <div class="text-center align-self-center">
                <img
                    src="{{ url_for('static', filename='images/icons8-invisible-90.png') }}" width="70" />
                <p><h4>This profile is private.</h4></p>
            </div>
            {% endif %}
        </div>
        <div class="lightbox hidden">
            <div class="lightbox-content">
                <div class="lightbox-controls">
                    <a href="#" class="lightbox-close"><button type="button"
                            class="btn btn-secondary">Close</button></a>
                    <a href="#" class="lightbox-prev">&#10094;</a>
                    <a href="#" class="lightbox-next">&#10095;</a>
                </div>
                <div class="lightbox-image">
                    <img src="" />
                    <p class="caption"></p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}